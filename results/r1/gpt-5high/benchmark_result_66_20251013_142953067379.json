{
  "benchmark_config": {
    "benchmark_id": "66_2025-10-13T14:29:53.067351",
    "jira_id": "66",
    "jira_title": "Implement/Test API: PUT /1.0/kb/bundles/{bundleId}/renameKey - Update a bundle externalKey",
    "benchmark_status": "completed",
    "total_run": 1,
    "total_passed": 1,
    "total_failed": 0
  },
  "test_config": {
    "benchmark_start_time": "2025-10-13T14:27:31.819955",
    "benchmark_end_time": "2025-10-13T14:29:53.067347",
    "framework": "analyze_gherkin_folder",
    "device": "Unknown",
    "llm_config": {
      "model": "gpt-5",
      "temperature": 1.0,
      "max_tokens": 16384,
      "seed": -1
    }
  },
  "benchmark_results": {
    "average_coverage_percentage": 90,
    "average_generation_time_seconds": 141.247392,
    "benchmark_output": [
      {
        "average_coverage_percentage": 90,
        "generation_time_seconds": 0.0,
        "generated_output_count": 1,
        "status": "completed",
        "gherkin_id": "66_qe_sup-gpt4.1_agent-gpt4.1_1748920286.feature",
        "coverage_analysis": [
          {
            "coverage_percentage": 90,
            "covered": [
              "PUT Valid Request: Success path returns 204 and persists new externalKey (TC01, TC14).",
              "PUT Non-Existing Resource: 404 on unknown bundleId and when no bundles exist (TC04, TC15).",
              "PUT Concurrency Issues: Concurrent updates to the same bundle are exercised so only one succeeds (TC17).",
              "PUT Partial Update behavior: Extra JSON fields are tolerated and only externalKey is applied (TC09).",
              "Validation and 400 errors: malformed bundleId, missing body, malformed JSON, missing externalKey, empty externalKey, missing required header, and key conflict on same account (TC02, TC03, TC05, TC06, TC07, TC08, TC11).",
              "Header handling: Required X-Killbill-CreatedBy enforced, optional Reason and Comment accepted (TC02, TC14).",
              "Authorization: Unauthorized or forbidden requests return 401 or 403 (TC12).",
              "Dependency failure handling: Service unavailable returns 503 (TC13).",
              "Non functional: Baseline response time under normal load is checked (TC23)."
            ],
            "gaps": [
              "Ambiguous outcomes in several scenarios reduce assertion strength and traceability (TC10, TC12, TC16, TC17, TC18, TC19, TC20).",
              "No test for 415 Unsupported Media Type when Content-Type is missing or not application/json.",
              "No explicit verification that 204 responses have no body and correct headers for success and errors.",
              "No idempotency test for renaming to the same externalKey value.",
              "No assertion that other Bundle fields cannot be updated and remain unchanged when extra fields are sent.",
              "No scenario confirming that a duplicate externalKey in a different account is allowed.",
              "Error payload structure is not asserted for schema consistency across 4xx and 5xx.",
              "Character set, trimming, and max length rules for externalKey are not defined with deterministic expected outcomes."
            ],
            "recommendations": [
              "Make all scenarios deterministic: define expected status codes and messages for length limits, character set, trimming, and concurrency. Replace dual outcomes in TC10, TC12, TC16, TC17, TC18, TC19, TC20.",
              "Add a 415 test for wrong or missing Content-Type to validate consumes application/json.",
              "Add an idempotency scenario where the new externalKey equals the current key and assert expected result.",
              "Verify only externalKey changes: after a successful update, fetch the bundle and assert no other fields changed. Also try to send another field and ensure it is ignored or rejected.",
              "Add a cross account test where the target key exists in a different account and confirm the update is allowed.",
              "Validate 204 semantics: assert no response body and correct headers; for errors, assert Content-Type and consistent error schema.",
              "Assert a standard error response format with code and message for 400, 401, 403, 404, 503.",
              "Optionally validate audit behavior by checking that CreatedBy, Reason, and Comment are recorded in audit logs or history endpoints."
            ],
            "usage": {
              "completion_tokens": 8151,
              "prompt_tokens": 6051,
              "total_tokens": 14202,
              "completion_tokens_details": {
                "accepted_prediction_tokens": 0,
                "audio_tokens": 0,
                "reasoning_tokens": 7488,
                "rejected_prediction_tokens": 0
              },
              "prompt_tokens_details": {
                "audio_tokens": 0,
                "cached_tokens": 0
              }
            }
          }
        ]
      }
    ]
  }
}